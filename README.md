
## 程序实现

#### 本小程序技术栈：

后端采用：MySQL + django

前端采用：小程序语法 + weui.wxss

#### 开发过程中遇到的技术问题

1、文档

开发过程大量参考了小程序官方文档，小程序网页平台可见

以及 github 上的相关 demo : https://github.com/justjavac/awesome-wechat-weapp

UI 使用了 weui.wxss: https://github.com/weui/weui-wxss/

2、前后端交互

后端向前端传递数据采用 json 字典作为数据流载体
前端向后端请求数据采用 POST 方法


3、登陆问题

小程序由于其特殊性，不能使用 session 机制，所以在 django 用户认证的时候遇到了一些麻烦

参考文章：http://www.cnblogs.com/ihardcoder/p/6279602.html

在此简述本小程序的登陆原理：

用户打开小程序时，向后端发送用户特有 code 以及加密用户信息，使用 code 请求微信服务器返回 session_key 和 openid，同时解密用户信息，比对 openid 。完成之后随机生成一组数据作为 cookie 返回前端，此后用户进行所有操作之前比对 cookie ，以此验证身份。

## 扫码入库小程序使用说明

#### 功能项

- 入库
- 出库
- 查询
- 设置

#### 使用

##### 0、配置后端 url 接口

进入 app.js 中修改 globalData 中的 domin 为后端接口地址

##### 1、初始化数据

进入小程序后，显示了仓库名与操作者，则说明：

1. 成功登陆后台系统
2. 成功从后台获取数据

反之则需要根据报错页面与控制台信息判断错误。

##### 2、入库

点击入库按钮，进行扫码操作，成功则进入保存页面。

如果数据库内有该商品信息，在保存页面会显示该商品的库存、商品名、备注信息，其中商品名、备注信息可进行修改，点击保存按钮进行保存操作。

如果数据库无该商品信息，需要手动填写商品名和备注信息。

备注：不填商品名则默认商品名为扫码结果的前 16 位字符。

##### 3、出库

点击出库按钮，进行扫码操作

当数据库有该商品信息，则进入出库保存页面，点击出库按钮即可；

当数据库无该商品信息，报错。

##### 4、查询

点击查询按钮，会显示当前操作库中的所有商品信息，点击仓库名可切换仓库查看其他仓库信息。

##### 5、设置

设置包含两个方面: 新建仓库、设置默认仓库

设置默认仓库可切换当前操作仓库，强烈建议出入库之前确认当前操作仓库，以免出入库错误。

新建仓库允许当前操作人建立属于自己的仓库。
